# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ß—Ç–æ –±—ã–ª–æ —É–ª—É—á—à–µ–Ω–æ

### 1. Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–µ–Ω—Ç—ã (–≤–º–µ—Å—Ç–æ polling)
**–ë—ã–ª–æ:** –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–ø—Ä–∞—à–∏–≤–∞–ª–æ Firebase –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö scrobbles
**–°—Ç–∞–ª–æ:** –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Firebase real-time subscriptions (WebSocket)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—è–≤–ª—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (–±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤ 30 —Å–µ–∫—É–Ω–¥)
- –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ Firebase (–æ–ø–ª–∞—Ç–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —á—Ç–µ–Ω–∏–π)
- –õ—É—á—à–∏–π UX - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ä–∞–∑—É

### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π polling –¥–ª—è Spotify API
**–ë—ã–ª–æ:** –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª 5 —Å–µ–∫—É–Ω–¥ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
**–°—Ç–∞–ª–æ:** –£–º–Ω—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª:
- **10 —Å–µ–∫—É–Ω–¥** - –∫–æ–≥–¥–∞ –∏–≥—Ä–∞–µ—Ç –º—É–∑—ã–∫–∞
- **30 —Å–µ–∫—É–Ω–¥** - –∫–æ–≥–¥–∞ –º—É–∑—ã–∫–∞ –Ω–∞ –ø–∞—É–∑–µ –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- **60+ —Å–µ–∫—É–Ω–¥** - –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ (—Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Spotify API –Ω–∞ 50-80%
- –ú–µ–Ω—å—à–µ —à–∞–Ω—Å–æ–≤ –ø–æ–ø–∞—Å—Ç—å –≤ rate limit
- –≠–∫–æ–Ω–æ–º–∏—è –±–∞—Ç–∞—Ä–µ–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

### 3. Exponential backoff –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
**–ë—ã–ª–æ:** –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∏ –æ–ø—Ä–∞—à–∏–≤–∞—Ç—å –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
**–°—Ç–∞–ª–æ:** –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –æ—à–∏–±–∫–∞—Ö –∑–∞–¥–µ—Ä–∂–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è: 60s ‚Üí 120s ‚Üí 240s ‚Üí –º–∞–∫—Å–∏–º—É–º 5 –º–∏–Ω—É—Ç

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ù–µ —Å–æ–∑–¥–∞—ë–º –ª–∏—à–Ω—é—é –Ω–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å Spotify API
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ–µ–≤
- –°–æ–±–ª—é–¥–µ–Ω–∏–µ best practices –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ rate limit (429 responses)
**–ë—ã–ª–æ:** –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–∏ —Å—Ç–∞—Ç—É—Å 429 –æ—Ç Spotify
**–°—Ç–∞–ª–æ:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Retry-After`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ Spotify API
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
- –ü–ª–∞–≤–Ω–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –®–∞–≥ 1: –°–∫–∞—á–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd notka-web

# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ
git checkout claude/project-review-plan-Wwhez

# –°–∫–∞—á–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin claude/project-review-plan-Wwhez

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npm install
```

### –®–∞–≥ 2: –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

```bash
# –°–æ–±—Ä–∞—Ç—å production –≤–µ—Ä—Å–∏—é
npm run build
```

### –®–∞–≥ 3: –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Firebase Hosting

```bash
# –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å
firebase deploy --only hosting
```

**–ì–æ—Ç–æ–≤–æ!** –ò–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–µ–Ω—Ç—ã
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –¥–≤—É—Ö –≤–∫–ª–∞–¥–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞
2. –í –æ–¥–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ –≤–∫–ª—é—á–∏—Ç–µ –º—É–∑—ã–∫—É –≤ Spotify
3. –í–æ –≤—Ç–æ—Ä–æ–π –≤–∫–ª–∞–¥–∫–µ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–µ–Ω—Ç–æ–π "–í—Å–µ" –∏–ª–∏ "–ú–æ–∏"
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–æ–≤—ã–π scrobble –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ**, –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤ 30 —Å–µ–∫—É–Ω–¥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π polling Spotify
1. –û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12) ‚Üí Console
2. –í–∫–ª—é—á–∏—Ç–µ –º—É–∑—ã–∫—É –≤ Spotify
3. –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –û–ø—Ä–æ—Å—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∫–∞–∂–¥—ã–µ ~10 —Å–µ–∫—É–Ω–¥
5. –ü–æ—Å—Ç–∞–≤—å—Ç–µ –º—É–∑—ã–∫—É –Ω–∞ –ø–∞—É–∑—É
6. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –æ–ø—Ä–æ—Å–∞–º–∏ —É–≤–µ–ª–∏—á–∏—Ç—Å—è –¥–æ ~30 —Å–µ–∫—É–Ω–¥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: Exponential backoff
1. –û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12) ‚Üí Network
2. –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ Spotify API
3. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –∫–æ–Ω—Å–æ–ª—å—é
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–∏ –ø–æ–¥–æ–∂–¥—ë—Ç 60—Å, –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–π 120—Å, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫
1. –û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12) ‚Üí Console
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–µ—Ç –∫—Ä–∞—Å–Ω—ã—Ö –æ—à–∏–±–æ–∫ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å Firebase –∏–ª–∏ Spotify API

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **src/services/firebase.ts**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `subscribeToRecentScrobbles()`, `subscribeToUserScrobbles()`, `subscribeToFollowingScrobbles()`
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç Firebase `onSnapshot()` –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

2. **src/hooks/useScrobbler.ts**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π polling —Å —Ç—Ä–µ–º—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ (10s/30s/60s)
   - –î–æ–±–∞–≤–ª–µ–Ω exponential backoff —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π 5 –º–∏–Ω—É—Ç
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫

3. **src/services/spotify.ts**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP 429 (Too Many Requests)
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Retry-After` –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –æ—à–∏–±–∫–∏

4. **src/pages/FeedPage.tsx**
   - –ó–∞–º–µ–Ω—ë–Ω polling –Ω–∞ real-time subscriptions
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø–∏—Å–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ callback `handleScrobblesUpdate`

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

| –ú–µ—Ç—Ä–∏–∫–∞ | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|------|-------|-----------|
| –ó–∞–¥–µ—Ä–∂–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–µ–Ω—Ç—ã | 0-30 —Å–µ–∫—É–Ω–¥ | <1 —Å–µ–∫—É–Ω–¥–∞ | **30x –±—ã—Å—Ç—Ä–µ–µ** |
| –ó–∞–ø—Ä–æ—Å–æ–≤ –∫ Spotify (–ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏) | 12/–º–∏–Ω—É—Ç—É | 6/–º–∏–Ω—É—Ç—É | **-50%** |
| –ó–∞–ø—Ä–æ—Å–æ–≤ –∫ Spotify (–Ω–∞ –ø–∞—É–∑–µ) | 12/–º–∏–Ω—É—Ç—É | 2/–º–∏–Ω—É—Ç—É | **-83%** |
| –ó–∞–ø—Ä–æ—Å–æ–≤ –∫ Firebase (–ª–µ–Ω—Ç–∞) | 2/–º–∏–Ω—É—Ç—É | 0 (real-time) | **-100%** |
| –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫ | –ù–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ | **+100%** |

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–≠—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è - —á–∞—Å—Ç—å **—Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏** –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–ï—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å –µ—â—ë –±–æ–ª—å—à–µ —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å:
- WebSockets –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π Spotify (—Å–ª–æ–∂–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç backend)
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç—Ä–µ–∫–æ–≤
- Service Worker –¥–ª—è offline-first –ø–æ–¥—Ö–æ–¥–∞
- Pagination –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤ scrobbles

–ù–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ç–µ–∫—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è —É–∂–µ –¥–∞–¥—É—Ç –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!

## –í–æ–ø—Ä–æ—Å—ã?

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã, –ø—Ä–æ–≤–µ—Ä—å:
1. –í–µ—Ä—Å–∏—è Firebase SDK –∞–∫—Ç—É–∞–ª—å–Ω–∞
2. Firestore Security Rules –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. .env —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏
4. –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ Browser Console

–£–¥–∞—á–∏! üöÄ
